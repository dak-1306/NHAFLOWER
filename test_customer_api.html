<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test API Kh√°ch H√†ng - NHAFLOWER</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px; padding: 15px; margin: 10px 0; }
        .success { border-color: #28a745; background: #d4edda; }
        .error { border-color: #dc3545; background: #f8d7da; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 3px; }
        .form-group { margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üå∏ Test API Kh√°ch H√†ng - NHAFLOWER</h1>
        
        <div class="form-group">
            <h3>1. L·∫•y danh s√°ch kh√°ch h√†ng</h3>
            <button onclick="getCustomers()">L·∫•y t·∫•t c·∫£ kh√°ch h√†ng</button>
        </div>

        <div class="form-group">
            <h3>2. L·∫•y kh√°ch h√†ng theo ID</h3>
            <input type="number" id="customerId" placeholder="Nh·∫≠p ID kh√°ch h√†ng" value="1">
            <button onclick="getCustomer()">L·∫•y kh√°ch h√†ng</button>
        </div>

        <div class="form-group">
            <h3>3. T·∫°o kh√°ch h√†ng m·ªõi</h3>
            <input type="text" id="newName" placeholder="T√™n kh√°ch h√†ng" value="Test User">
            <input type="text" id="newPhone" placeholder="S·ªë ƒëi·ªán tho·∫°i" value="0999888777">
            <input type="text" id="newAddress" placeholder="ƒê·ªãa ch·ªâ" value="Test Address">
            <input type="number" id="newAccountId" placeholder="ID t√†i kho·∫£n" value="1">
            <button onclick="createCustomer()">T·∫°o kh√°ch h√†ng</button>
        </div>

        <div class="form-group">
            <h3>4. C·∫≠p nh·∫≠t kh√°ch h√†ng</h3>
            <input type="number" id="updateId" placeholder="ID kh√°ch h√†ng c·∫ßn c·∫≠p nh·∫≠t" value="1">
            <input type="text" id="updateName" placeholder="T√™n m·ªõi" value="Updated Name">
            <input type="text" id="updatePhone" placeholder="SƒêT m·ªõi" value="0911888999">
            <input type="text" id="updateAddress" placeholder="ƒê·ªãa ch·ªâ m·ªõi" value="Updated Address">
            <button onclick="updateCustomer()">C·∫≠p nh·∫≠t</button>
        </div>

        <div class="form-group">
            <h3>5. X√≥a kh√°ch h√†ng</h3>
            <input type="number" id="deleteId" placeholder="ID kh√°ch h√†ng c·∫ßn x√≥a">
            <button onclick="deleteCustomer()" style="background: #dc3545;">X√≥a kh√°ch h√†ng</button>
        </div>

        <div id="result" class="result" style="display: none;">
            <h4>K·∫øt qu·∫£:</h4>
            <pre id="resultContent"></pre>
        </div>
    </div>

    <script>
        const baseUrl = 'http://localhost/nhaflower/api/khach_hang/';
        
        function showResult(data, isSuccess = true) {
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            
            resultDiv.style.display = 'block';
            resultDiv.className = isSuccess ? 'result success' : 'result error';
            resultContent.textContent = JSON.stringify(data, null, 2);
        }

        async function getCustomers() {
            try {
                const response = await fetch(baseUrl + 'get_customers.php');
                const data = await response.json();
                showResult(data);
            } catch (error) {
                showResult({error: error.message}, false);
            }
        }

        async function getCustomer() {
            const id = document.getElementById('customerId').value;
            try {
                const response = await fetch(baseUrl + `get_customer.php?id=${id}`);
                const data = await response.json();
                showResult(data);
            } catch (error) {
                showResult({error: error.message}, false);
            }
        }

        async function createCustomer() {
            const customerData = {
                ten_khachhang: document.getElementById('newName').value,
                so_dien_thoai: document.getElementById('newPhone').value,
                dia_chi: document.getElementById('newAddress').value,
                id_taikhoan: document.getElementById('newAccountId').value
            };

            try {
                const response = await fetch(baseUrl + 'create_customer.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(customerData)
                });
                const data = await response.json();
                showResult(data, data.success);
            } catch (error) {
                showResult({error: error.message}, false);
            }
        }

        async function updateCustomer() {
            const id = document.getElementById('updateId').value;
            const customerData = {
                ten_khachhang: document.getElementById('updateName').value,
                so_dien_thoai: document.getElementById('updatePhone').value,
                dia_chi: document.getElementById('updateAddress').value
            };

            try {
                const response = await fetch(baseUrl + `update_customer.php?id=${id}`, {
                    method: 'POST', // L∆∞u √Ω: API hi·ªán t·∫°i d√πng POST thay v√¨ PUT
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(customerData)
                });
                const data = await response.json();
                showResult(data, data.success);
            } catch (error) {
                showResult({error: error.message}, false);
            }
        }

        async function deleteCustomer() {
            const id = document.getElementById('deleteId').value;
            if (!confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√°ch h√†ng n√†y?')) return;

            try {
                const response = await fetch(baseUrl + `delete_customer.php?id=${id}`, {
                    method: 'GET' // L∆∞u √Ω: API hi·ªán t·∫°i d√πng GET thay v√¨ DELETE
                });
                const data = await response.json();
                showResult(data, data.success);
            } catch (error) {
                showResult({error: error.message}, false);
            }
        }
    </script>
</body>
</html>
