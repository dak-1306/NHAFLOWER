<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart.js Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
        canvas { border: 1px solid #ddd; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Chart.js Loading Debug Test</h1>
    <div id="status"></div>
    <div id="chart-container">
        <canvas id="testChart" width="400" height="200"></canvas>
    </div>

    <!-- Test 1: Local Chart.js Bundle -->
    <script>
        function addStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}:</strong> ${message}`;
            statusDiv.appendChild(div);
            console.log(message);
        }

        addStatus('Starting Chart.js debug test...');
        addStatus('Attempting to load Chart.js from local bundle...');
    </script>

    <!-- Load Chart.js from local bundle -->
    <script src="../assets/vendor/chart.js/Chart.bundle.min.js"></script>
    
    <script>
        // Check if Chart.js loaded
        setTimeout(() => {
            if (typeof Chart !== 'undefined') {
                addStatus(`✓ Chart.js loaded successfully! Version: ${Chart.version || 'Unknown'}`, 'success');
                
                // Try to create a simple chart
                try {
                    const ctx = document.getElementById('testChart').getContext('2d');
                    const chart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Test 1', 'Test 2', 'Test 3'],
                            datasets: [{
                                label: 'Test Data',
                                data: [12, 19, 3],
                                backgroundColor: ['#ff6384', '#36a2eb', '#cc65fe']
                            }]
                        },
                        options: {
                            responsive: false,
                            scales: {
                                yAxes: [{
                                    ticks: { beginAtZero: true }
                                }]
                            }
                        }
                    });
                    addStatus('✓ Test chart created successfully!', 'success');
                } catch (error) {
                    addStatus(`✗ Failed to create test chart: ${error.message}`, 'error');
                    console.error('Chart creation error:', error);
                }
            } else {
                addStatus('✗ Chart.js failed to load from local bundle', 'error');
                
                // Try CDN fallback
                addStatus('Attempting CDN fallback...', 'info');
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.bundle.min.js';
                script.onload = () => {
                    addStatus(`✓ Chart.js loaded from CDN! Version: ${Chart.version || 'Unknown'}`, 'success');
                };
                script.onerror = () => {
                    addStatus('✗ CDN fallback also failed', 'error');
                };
                document.head.appendChild(script);
            }
        }, 500);
    </script>
</body>
</html>
